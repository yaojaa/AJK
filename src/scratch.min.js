function extend(t,e){for(var n in e)t[n]=e[n];return t}var Scratch=function(t,e){"use strict";this.selector=typeof t=="string"?document.getElementById(t):t;this.defaults={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,fontImg:"img/font.jpg",bgImg:"img/bg.jpg",percent:.6,callback:function(){}};this.defaults=extend(this.defaults,e);this.init()};Scratch.prototype={init:function(){var t=this;var e=document.createElement("canvas");e.width=this.defaults.width;e.height=this.defaults.height;e.style.backgroundImage='url("'+this.defaults.bgImg+'")';e.style.backgroundPosition="center bottom";this.selector.appendChild(e);var n=e.getContext("2d");var a=new Image;a.src=this.defaults.fontImg;a.onload=function(){n.drawImage(a,0,0,t.defaults.width,t.defaults.height)};this.canvas=e;this.ctx=n;this.bindAction()},bindAction:function(){var t=this;var e=false;var n=function(n){if(e){var n="ontouchstart"in window?n.touches[0]:n;var a=n.pageX-t.canvas.offsetLeft;var i=n.pageY-t.canvas.offsetTop;t.ctx.globalCompositeOperation="destination-out";t.ctx.beginPath();t.ctx.arc(a,i,45,0,Math.PI*2,true);t.ctx.closePath();t.ctx.fill()}};var a=function(t){t.preventDefault();e=true;n(t)};var i=function(t){n(t)};var c=function(n){e=false;var o=t.ctx.getImageData(0,0,t.defaults.width,t.defaults.width).data;for(var s=0,r=0;s<=o.length;s+=4){if(o[s+3]==255){r++}}if(r<=t.defaults.width*t.defaults.height*(1-t.defaults.percent)||/HM/.test(navigator.userAgent)){t.ctx.clearRect(0,0,t.defaults.width,t.defaults.height);typeof t.defaults.callback==="function"&&t.defaults.callback();t.canvas.removeEventListener("touchstart",a);t.canvas.removeEventListener("touchmove",i);t.canvas.removeEventListener("touchend",c)}};if("ontouchstart"in window){t.canvas.addEventListener("touchstart",a);t.canvas.addEventListener("touchmove",i);t.canvas.addEventListener("touchend",c)}t.canvas.addEventListener("mousedown",a);t.canvas.addEventListener("mousemove",i);t.canvas.addEventListener("mouseup",c)}};if(window.jQuery||window.Zepto){(function(t){"use strict";t.fn.Scratch=function(e){var n;this.each(function(n){var a=t(this);var i=new Scratch(a[0],e)});return n}})(window.jQuery||window.Zepto)}if(typeof module!=="undefined"){module.exports=Scratch}if(typeof define==="function"&&define.amd){define([],function(){"use strict";return Scratch})}